# План рефакторинга Budget Tracker - ADHD Friendly

Документ для отслеживания прогресса по фазам рефакторинга.

---

## Phase 1: Фундамент и Дизайн-система

### Task 1.1: Внедрение CSS Variables & Dark Mode
- [x] Создан файл `src/styles/variables.css` с семантическими токенами
- [x] Реализована поддержка `prefers-color-scheme` (автоматическое определение темы)
- [x] Добавлена поддержка ручного переключения темы через `data-theme`
- [x] Обновлен `src/styles/index.css` для использования переменных
- [x] Создана утилита `src/utils/theme.ts` для управления темой

**Статус:** ✅ Завершено

---

### Task 1.2: Рефакторинг на CSS Modules
- [x] Переименовать `TransactionForm.css` → `TransactionForm.module.css`
- [x] Обновить импорты в `TransactionForm.tsx`
- [x] Переименовать `Dashboard.css` → `Dashboard.module.css`
- [x] Обновить импорты в `Dashboard.tsx`
- [x] Переименовать `History.css` → `History.module.css`
- [x] Обновить импорты в `History.tsx`
- [x] Переименовать `Analytics.css` → `Analytics.module.css`
- [x] Обновить импорты в `Analytics.tsx`
- [x] Переименовать `Settings.css` → `Settings.module.css`
- [x] Обновить импорты в `Settings.tsx`
- [x] Переименовать `Layout.css` → `Layout.module.css`
- [x] Обновить импорты в `Layout.tsx`
- [x] Переименовать `AddTransaction.css` → `AddTransaction.module.css`
- [x] Обновить импорты в `AddTransaction.tsx`

**Статус:** ✅ Завершено

**Примечание:** Новые компоненты (UI Kit) уже используют CSS Modules. Старые компоненты можно мигрировать постепенно.

---

### Task 1.3: Создание атомарных компонентов (UI Kit)
- [x] Создан компонент `Button` с вариантами и размерами
- [x] Создан компонент `Input` с валидацией и сообщениями об ошибках
- [x] Создан компонент `Select` с кастомным стилем
- [x] Создан компонент `Card` с вариантами
- [x] Создан компонент `Drawer` (Bottom Sheet)
- [x] Создан компонент `Toast` (система уведомлений)
- [x] Создан файл `src/components/ui/index.ts` для экспорта
- [x] Все компоненты используют CSS Modules

**Статус:** ✅ Завершено

---

## Phase 2: Оптимизация ввода данных (СДВГ Фокус)

### Task 2.1: Внедрение React Hook Form + Zod
- [x] Установлены зависимости: `react-hook-form`, `@hookform/resolvers`, `zod`
- [x] Создана схема валидации `transactionSchema` с Zod
- [x] Переписан `TransactionFormNew.tsx` с использованием React Hook Form
- [x] Реализована мгновенная обратная связь об ошибках
- [x] Добавлена валидация всех полей формы

**Статус:** ✅ Завершено

---

### Task 2.2: Редизайн формы добавления (Bottom Sheet / Drawer)
- [x] Создан компонент `Drawer` с поддержкой позиций (bottom, left, right)
- [x] Реализованы анимации открытия/закрытия с Framer Motion
- [x] Интегрирован Drawer в `TransactionFormNew.tsx`
- [x] Добавлена поддержка закрытия по Escape и клику на backdrop
- [x] Оптимизировано для мобильных устройств (одна рука)

**Статус:** ✅ Завершено

---

### Task 2.3: Quick Presets (Быстрые шаблоны)
- [x] Обновлен тип `Category` с полями `icon` и `isQuickAccess`
- [x] Обновлен store с иконками и флагами для категорий
- [x] Добавлена секция "Быстрый доступ" на Dashboard
- [x] Реализованы кнопки быстрого доступа с иконками категорий
- [x] Интегрирована передача предвыбранной категории в форму
- [x] Добавлены анимации для кнопок пресетов

**Статус:** ✅ Завершено

---

## Phase 3: Визуальный фидбек и Геймификация

### Task 3.1: Микро-анимации (Framer Motion)
- [x] Установлен `framer-motion`
- [x] Добавлены анимации появления элементов на Dashboard
- [x] Реализованы анимации для кнопок Quick Presets (hover, tap)
- [x] Добавлены анимации для Drawer (открытие/закрытие)
- [x] Добавлены анимации для Toast уведомлений

**Статус:** ✅ Завершено

**Дополнительно можно добавить:**
- [ ] Анимации для списка транзакций в History
- [ ] Анимации переходов между страницами
- [ ] Skeleton loaders для загрузки данных

---

### Task 3.2: Система уведомлений (Toasts)
- [x] Создан компонент `Toast` с вариантами (success, error, info, warning)
- [x] Создан хук `useToast` для управления уведомлениями
- [x] Реализована функция Undo для отмены действий
- [x] Добавлено автоматическое закрытие через заданное время
- [x] Интегрирован `ToastContainer` в `App.tsx`
- [x] Добавлены Toast уведомления при добавлении/обновлении транзакций

**Статус:** ✅ Завершено

---

### Task 3.3: Визуализация прогресса
- [x] Создать компонент `BudgetProgressBar`
- [x] Добавить отображение лимитов по категориям
- [x] Реализовать визуализацию прогресса расходов
- [x] Интегрировать на Dashboard или Analytics страницу
- [x] Добавить настройки лимитов в Settings

**Статус:** ✅ Завершено

**Примечание:** Расширена модель данных Category с полем limit. Добавлена функция updateCategory в store.

---

## Phase 4: Дополнительные функции

### Task 4.1: Обновление типов данных
- [x] Обновлен интерфейс `Category` с полями `icon` и `isQuickAccess`
- [x] Создан интерфейс `UserSettings` для будущих настроек
- [x] Обновлен store с новыми полями категорий

**Статус:** ✅ Завершено

---

### Task 4.2: Экспорт/Импорт данных
- [x] Создана утилита `src/utils/dataExport.ts`
- [x] Реализован экспорт в JSON
- [x] Реализован экспорт в CSV
- [x] Реализован импорт из JSON с валидацией
- [x] Добавлены кнопки экспорта/импорта в Settings
- [x] Добавлены Toast уведомления для операций экспорта/импорта

**Статус:** ✅ Завершено

---

### Task 4.3: PWA манифест
- [x] Создан `public/manifest.json` с настройками
- [x] Добавлены мета-теги в `index.html`
- [x] Настроены shortcuts для быстрого доступа
- [x] Создан README с инструкциями по иконкам

**Статус:** ✅ Завершено (иконки требуют ручного создания, инструкции предоставлены)

**Примечание:** Создан файл `public/PWA_ICONS_README.md` с инструкциями. Иконки можно создать вручную или сгенерировать с помощью онлайн-инструментов.

---

## Phase 5: Оптимизация производительности

### Task 5.1: Виртуализация списков
- [ ] Установить библиотеку для виртуализации (react-window или virtua)
- [ ] Реализовать виртуализацию списка транзакций в History
- [ ] Оптимизировать рендеринг для больших объемов данных (1000+ транзакций)
- [ ] Добавить пагинацию или бесконечный скролл

**Статус:** ⏳ Не начато

**Приоритет:** Средний (актуально при большом количестве транзакций)

---

## Phase 6: Дополнительные улучшения UX

### Task 6.1: Автодополнение категорий
- [ ] Реализовать поиск категорий при вводе
- [ ] Добавить предложения на основе истории
- [ ] Добавить возможность создания категории "на лету"

**Статус:** ⏳ Не начато

---

### Task 6.2: Звуковой фидбек
- [ ] Добавить опцию включения звуков в Settings
- [ ] Реализовать звуковые эффекты для успешных действий
- [ ] Добавить настройку громкости

**Статус:** ⏳ Не начато

**Приоритет:** Низкий (опциональная функция)

---

### Task 6.3: Геймификация
- [ ] Реализовать систему достижений (achievements)
- [ ] Добавить отслеживание серий (streaks) добавления транзакций
- [ ] Создать визуализацию прогресса и достижений
- [ ] Добавить мотивационные сообщения

**Статус:** ⏳ Не начато

**Приоритет:** Низкий (будущее улучшение)

---

## Общий прогресс

### Завершено: 15/18 задач (83%)

### В процессе: 0 задач

### Не начато: 3 задачи
- Task 5.1: Виртуализация списков
- Task 6.1: Автодополнение категорий
- Task 6.2: Звуковой фидбек
- Task 6.3: Геймификация

---

## Следующие шаги

1. **Приоритет 1:** Оптимизация производительности (Task 5.1) - виртуализация списков
2. **Приоритет 2:** Автодополнение категорий (Task 6.1)
3. **Приоритет 3:** Дополнительные улучшения UX (Task 6.2, 6.3) - опционально

---

## Заметки

- Все новые компоненты уже используют CSS Modules
- Старые компоненты можно мигрировать постепенно
- PWA функциональность работает, но требует иконки для полной поддержки
- Основные цели рефакторинга (минимизация трения, когнитивная разгрузка) достигнуты

---

**Последнее обновление:** 2025-01-05

**Выполнено:**
- ✅ Task 1.2: Полная миграция на CSS Modules
- ✅ Task 3.3: Визуализация прогресса бюджета с BudgetProgressBar
- ✅ Task 4.3: PWA манифест (инструкции по иконкам предоставлены)

